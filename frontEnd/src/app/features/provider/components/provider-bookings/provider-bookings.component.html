<div class="provider-bookings">
  <div class="header">
    <h2>Manage Bookings</h2>
    <button class="refresh-btn" (click)="loadBookings()" [disabled]="loading">
      {{ loading ? 'Loading...' : 'Refresh' }}
    </button>
  </div>
  <div *ngIf="loading" class="loading">Loading bookings...</div>
  <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
  <div *ngIf="successMessage" class="success">{{ successMessage }}</div>
  
  <div *ngIf="!loading && bookings.length === 0" class="no-bookings">
    <p>No bookings found for your resources.</p>
  </div>

  <div *ngIf="!loading && bookings.length > 0" class="bookings-table-container">
    <table class="bookings-table">
      <thead>
        <tr>
          <th>Booking ID</th>
          <th>Customer</th>
          <th>Customer Email</th>
          <th>Customer Phone</th>
          <th>Service</th>
          <th>Provider</th>
          <th>Date</th>
          <th>Time</th>
          <th>Status</th>
          <th>Amount</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let b of bookings">
          <td>{{ b.id }}</td>
          <td>{{ b.customerName }}</td>
          <td>{{ b.customerEmail }}</td>
          <td>{{ b.customerPhone || 'N/A' }}</td>
          <td>{{ b.resourceName || 'N/A' }}</td>
          <td>{{ b.providerName || 'N/A' }}</td>
          <td>{{ b.startTime | date:'shortDate' }}</td>
          <td>{{ b.startTime | date:'shortTime' }} - {{ b.endTime | date:'shortTime' }}</td>
          <td>
            <span class="status-badge" [ngClass]="'status-' + b.status">{{ b.status }}</span>
          </td>
          <td>${{ b.finalAmount || 0 }}</td>
          <td class="actions">
            <button class="edit-btn" (click)="editBooking(b)">Edit</button>
            <button class="delete-btn" (click)="deleteBooking(b.id)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Edit Booking Modal -->
  <div *ngIf="showEditModal" class="modal-overlay" (click)="closeEditModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h3>Edit Booking</h3>
      <form (ngSubmit)="submitEdit()">
        <div class="form-group">
          <label for="status">Status:</label>
          <select id="status" [(ngModel)]="editForm.status" name="status" required>
            <option value="pending">Pending</option>
            <option value="confirmed">Confirmed</option>
            <option value="cancelled">Cancelled</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="startTime">Start Time:</label>
          <input type="datetime-local" id="startTime" [(ngModel)]="editForm.startTime" name="startTime" required>
        </div>
        
        <div class="form-group">
          <label for="endTime">End Time:</label>
          <input type="datetime-local" id="endTime" [(ngModel)]="editForm.endTime" name="endTime" required>
        </div>
        
        <div class="form-actions">
          <button type="button" (click)="closeEditModal()">Cancel</button>
          <button type="submit">Save Changes</button>
        </div>
      </form>
    </div>
  </div>
</div>
