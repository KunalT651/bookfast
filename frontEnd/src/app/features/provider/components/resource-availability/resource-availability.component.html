<div class="availability-container">
  <h3>Manage Availability Slots</h3>
  <form class="slot-form" [formGroup]="slotForm" (ngSubmit)="submitSlot()">
    <label>
      Date:
      <input type="date" formControlName="date" required />
    </label>
    <label>
      Day of Week:
      <input type="text" [value]="getSlotDay(slotForm.get('date')?.value)" readonly />
    </label>
    <label>
      Start Time:
      <input formControlName="startTime" type="time" required placeholder="Start Time">
    </label>
    <label>
      End Time:
      <input formControlName="endTime" type="time" required placeholder="End Time">
    </label>
    <label>
      Status:
      <select formControlName="status" required>
        <option value="available">Available</option>
        <option value="booked">Booked</option>
        <option value="unavailable">Unavailable</option>
      </select>
    </label>
    <label *ngIf="isUnavailableStatus">
      Reason (optional):
      <input 
        type="text" 
        formControlName="reason" 
        placeholder="e.g., Vacation, Maintenance, Holiday, Personal time, etc."
      />
    </label>
    <div class="form-actions">
      <button type="submit">{{ selectedAvailabilitySlot ? 'Update Slot' : 'Add Slot' }}</button>
      <button type="button" (click)="clearForm()" *ngIf="selectedAvailabilitySlot">Cancel</button>
    </div>
  </form>
  <div *ngIf="error" class="error-message">{{ error }}</div>
  <div *ngIf="success" class="success-message">{{ success }}</div>

  <h4 style="margin-top:2rem;">Current Slots</h4>
  <ul *ngIf="availabilitySlots.length">
    <li *ngFor="let slot of availabilitySlots" (click)="selectAvailabilitySlot(slot)">
      <span>{{ getSlotDay(slot.date) }} {{ slot.startTime }}-{{ slot.endTime }} ({{ slot.status === 'unavailable' && slot.reason ? 'unavailable - ' + slot.reason : slot.status }})</span>
      <button (click)="deleteSlot(slot.id!); $event.stopPropagation()">Delete</button>
    </li>
  </ul>
  <div *ngIf="!availabilitySlots.length" class="no-slots-message">No slots added yet. Use the form above to add availability.</div>
</div>